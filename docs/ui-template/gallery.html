<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>UI Theme Gallery</title>
    <style>
      body{margin:0;font:14px/1.6 -apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial,'Noto Sans JP','Hiragino Kaku Gothic ProN','Yu Gothic','Meiryo',sans-serif;background:#f5f7fb}
      header{display:flex;align-items:center;gap:12px;padding:10px 12px;border-bottom:1px solid #e5e7eb;background:#fff;position:sticky;top:0}
      header .grow{flex:1}
      .grid{display:grid;gap:12px;padding:12px;grid-template-columns:repeat(auto-fill,minmax(380px,1fr))}
      figure{margin:0;border:1px solid #e5e7eb;border-radius:12px;overflow:hidden;background:#fff;box-shadow:0 2px 8px rgba(0,0,0,.06)}
      figcaption{padding:8px 10px;border-top:1px solid #e5e7eb;font-weight:600;display:flex;align-items:center;gap:8px}
      iframe{width:100%;height:420px;border:0;display:block}
      .btn{border:1px solid #e5e7eb;background:#fff;padding:6px 10px;border-radius:8px;cursor:pointer}
    </style>
  </head>
  <body>
    <header>
      <strong>UI Theme Gallery</strong>
      <div class="grow"></div>
      <label class="btn" title="Preview icon image (PNG/JPG/WebP). Applies to all previews.">
        Icon Image
        <input id="iconPick" type="file" accept="image/*" style="display:none" />
      </label>
      <label class="btn" title="Custom Theme CSS (.css). Must override CSS variables (e.g., :root { --bg: ... })">
        Custom Theme CSS
        <input id="cssPick" type="file" accept="text/css,.css" style="display:none" />
      </label>
    </header>
    <div style="padding:8px 12px;color:#64748b;font-size:12px">
      • Icon Image: プレビュー内のアイコンに適用（画像ファイル） / • Custom Theme CSS: CSS変数を上書きする .css を読み込み（:root の --bg/--paper/--text/--pri 等）
    </div>
    <section class="grid" id="grid"></section>
    <script>
      const themes = [
        { id:'dark', label:'Dark' },
        { id:'cyberpunk', label:'Cyberpunk' },
        { id:'izakaya', label:'IZAKAYA' }
      ];
      const grid = document.getElementById('grid');
      for(const t of themes){
        const fig = document.createElement('figure');
        const url = `./preview.html?theme=${encodeURIComponent(t.id)}`;
        fig.innerHTML = `<iframe src="${url}"></iframe><figcaption>${t.label}</figcaption>`;
        grid.appendChild(fig);
      }
      document.getElementById('iconPick')?.addEventListener('change', async (e)=>{
        const f = e.target.files && e.target.files[0]; if(!f) return;
        const url = URL.createObjectURL(f);
        document.querySelectorAll('iframe').forEach(fr => {
          fr.contentWindow?.postMessage({type:'setIcon', dataUrl:url}, '*');
        });
      });
      document.getElementById('cssPick')?.addEventListener('change', async (e)=>{
        const f = e.target.files && e.target.files[0]; if(!f) return;
        const url = URL.createObjectURL(f);
        document.querySelectorAll('iframe').forEach(fr => {
          fr.contentWindow?.postMessage({type:'setThemeHref', href:url}, '*');
        });
      });
    </script>
  </body>
  </html>
